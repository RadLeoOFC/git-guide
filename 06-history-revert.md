# История и откаты в Git

Работа с историей — ключ к пониманию того, что происходило в проекте.  
Здесь мы рассмотрим команды для просмотра изменений, анализа разницы и отката к нужным состояниям.

---

## `git log` — просмотр истории коммитов

Показывает историю коммитов текущей ветки, начиная с самого последнего.

**Что отображает:**
- Хэш коммита (SHA)
- Имя автора
- Дату коммита
- Сообщение коммита

**Примеры:**
```bash
git log                         # Полная история
git log --oneline               # Каждое изменение в 1 строку
git log --graph                 # ASCII-граф ветвлений
git log --decorate              # Показывает ссылки (ветки, теги)
git log --all                   # История всех веток
git log -n 5                    # Последние 5 коммитов
```

---

## `git diff` — сравнение изменений

Показывает разницу между файлами в разных состояниях.

**Примеры:**
```bash
git diff                        # Разница между рабочей директорией и индексом (staging)
git diff --staged               # Разница между индексом и последним коммитом
git diff <commit_hash>          # Разница между рабочей директорией и указанным коммитом
git diff <commit1> <commit2>    # Разница между двумя коммитами
git diff main~1 main -- src/app.py  # Разница для конкретного файла
```

**Совет:** Перед коммитом полезно делать `git diff --staged`, чтобы убедиться, что добавляете именно те изменения.

---

## `git revert` — откат с сохранением истории

Создаёт новый коммит, который отменяет изменения указанного коммита (история проекта не изменяется).

**Примеры:**
```bash
git revert <hash>               # Откат конкретного коммита
git revert HEAD                  # Откат последнего коммита
git revert HEAD~2..HEAD          # Откат нескольких последних коммитов
git revert --no-edit <hash>      # Откат без изменения сообщения
git revert -n <hash1> <hash2>    # Откатить несколько коммитов без отдельных коммитов
```

**Используйте revert в командной работе**, чтобы не переписывать историю, видимую другим.

---

## `git reset` — перемещение HEAD на другой коммит

Меняет текущую ветку и состояние staging/рабочей директории в зависимости от режима.

**Примеры:**
```bash
git reset --soft HEAD~1          # Откатить на 1 коммит назад, изменения останутся в staging
git reset HEAD~1                  # Изменения останутся в рабочих файлах, но будут unstaged
git reset --hard <hash>           # Полный откат до состояния указанного коммита (опасно!)
```

**Осторожно:**  
- `--hard` удалит все несохранённые изменения без возможности восстановления.  
- Не используйте `reset` на общих ветках, если коммиты уже отправлены в удалённый репозиторий.

---

## Памятка по выбору команды для отката

| Цель                               | Команда       | Безопасно для командной работы |
|------------------------------------|--------------|---------------------------------|
| Отменить изменения, но оставить их в коде | `git reset`   | ❌ (если в общей ветке)         |
| Откатить и сохранить историю       | `git revert`  | ✅                              |
| Откатить локально, без сохранения  | `git reset --hard` | ❌ (опасно)                |

---

## Рабочие сценарии

1. **Посмотреть последние изменения:**
```bash
git log --oneline --graph --decorate -n 10
```

2. **Сравнить с предыдущей версией:**
```bash
git diff HEAD~1 HEAD
```

3. **Откатить ошибочный коммит без потери истории:**
```bash
git revert HEAD
```

4. **Вернуться к прошлому состоянию (локально):**
```bash
git reset --hard HEAD~2
```
