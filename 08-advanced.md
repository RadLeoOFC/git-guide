# ‚öôÔ∏è 08 Advanced ‚Äî –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ä–∞–±–æ—Ç–∞ —Å Git

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏, —Ç–æ—á–µ—á–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –∫–æ–º–º–∏—Ç–æ–≤, –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤.

---

## üß≠ `git rebase` ‚Äî –ø–µ—Ä–µ–Ω–æ—Å –∫–æ–º–º–∏—Ç–æ–≤ –ø–æ–≤–µ—Ä—Ö –¥—Ä—É–≥–æ–π –±–∞–∑—ã

–ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é: ¬´–ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç¬ª –≤–∞—à–∏ –∫–æ–º–º–∏—Ç—ã –ø–æ–≤–µ—Ä—Ö —Ü–µ–ª–µ–≤–æ–π –≤–µ—Ç–∫–∏/–∫–æ–º–º–∏—Ç–∞.

üìå **–í–∞–∂–Ω–æ:** –Ω–µ –¥–µ–ª–∞–π—Ç–µ `rebase` –ø—É–±–ª–∏—á–Ω—ã—Ö –≤–µ—Ç–æ–∫, –µ—Å–ª–∏ –∫–æ–º–º–∏—Ç—ã —É–∂–µ —É—à–ª–∏ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π ‚Äî —ç—Ç–æ –ª–æ–º–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∫–æ–ª–ª–µ–≥.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—ë–º—ã
```bash
git rebase <upstream>                 # –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¢–ï–ö–£–©–£–Æ –≤–µ—Ç–∫—É –ø–æ–≤–µ—Ä—Ö <upstream>
git rebase -i <upstream>              # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π rebase: squash/fixup/reword/drop
git rebase --onto <newbase> <upstream> [branch]
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–º–º–∏—Ç—ã –∏–∑ branch, –∫–æ—Ç–æ—Ä—ã–µ –ª–µ–∂–∞—Ç –ü–û–°–õ–ï <upstream>, –Ω–∞ –±–∞–∑—É <newbase>

git rebase --continue                 # –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ—Å–ª–µ —Ä—É—á–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
git rebase --abort                    # –û—Ç–º–µ–Ω–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
git rebase --skip                      # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–º–º–∏—Ç
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –æ–ø—Ü–∏–∏
```bash
git rebase -i --autosquash <upstream> # –ê–≤—Ç–æ—Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ fixup!/squash! –∫–æ–º–º–∏—Ç–æ–≤
git rebase --rebase-merges            # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å) —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–µ—Ä–¥–∂–µ–π
git rebase --autostash <upstream>     # –ê–≤—Ç–æ-stash –¥–æ —Ä–µ–±–µ–π–∑–∞ –∏ –∞–≤—Ç–æ-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
git rebase --keep-base                # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—É—é –±–∞–∑—É (–ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ fork)
```

üí° **–°–æ–≤–µ—Ç—ã:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `fixup!`/`squash!` –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∫–æ–º–º–∏—Ç–æ–≤, —á—Ç–æ–±—ã —Å `--autosquash` –±—ã—Å—Ç—Ä–æ —á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é.
- –î–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π —Ç–æ–Ω–∫–æ–π –∏—Å—Ç–æ—Ä–∏–∏: `git config --global pull.rebase true` –∏ (–ø–æ –∂–µ–ª–∞–Ω–∏—é) `rebase.autosquash=true`, `rebase.autoStash=true`.

---

## üéØ `git cherry-pick` ‚Äî –≤—ã–±–æ—Ä–æ—á–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–º–º–∏—Ç—ã

–ë–µ—Ä—ë—Ç –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö** –∫–æ–º–º–∏—Ç–æ–≤ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö –ø–æ–≤–µ—Ä—Ö —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–∏.

### –ü—Ä–∏–º–µ—Ä—ã
```bash
git cherry-pick <hash>                # –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–¥–∏–Ω –∫–æ–º–º–∏—Ç
git cherry-pick <A>^..<B>             # –î–∏–∞–ø–∞–∑–æ–Ω: —Å A –í–ö–õ–Æ–ß–ê–Ø –ø–æ B (–ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è)
git cherry-pick --continue            # –ü–æ—Å–ª–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
git cherry-pick --skip                 # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–º–º–∏—Ç
git cherry-pick --abort                # –û—Ç–º–µ–Ω–∏—Ç—å cherry-pick
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –æ–ø—Ü–∏–∏
```bash
git cherry-pick -n <hash>             # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–º–∏—Ç–∞ (accumulate)
git cherry-pick -x <hash>             # –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
git cherry-pick --strategy-option theirs|ours  # –í —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö (—Ç–æ—á–µ—á–Ω–æ)
```

‚ö†Ô∏è **–ü–æ–º–Ω–∏—Ç–µ:** cherry-pick –¥—É–±–ª–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω–æ–≤–æ–π —Ç–æ—á–∫–µ –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî —ç—Ç–æ –¥—Ä—É–≥–æ–π hash. –î–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ ¬´–≤–µ—Ç–∫–∏ —Ü–µ–ª–∏–∫–æ–º¬ª —á–∞—â–µ –ø–æ–¥—Ö–æ–¥–∏—Ç `rebase`/`merge`.

---

## üóÇ `git stash` ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ —É–±—Ä–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è ¬´–Ω–∞ –ø–æ–ª–∫—É¬ª

–£–±–∏—Ä–∞–µ—Ç –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É, –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –∏—Ö –ø–æ–∑–∂–µ.

### –ë–∞–∑–∞
```bash
git stash push -m "msg"               # –°–ø—Ä—è—Ç–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (tracked)
git stash push -u -m "msg"            # –í–∫–ª—é—á–∞—è untracked —Ñ–∞–π–ª—ã
git stash push -a -m "msg"            # –í–∫–ª—é—á–∞—è –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã (.gitignore)
git stash list                         # –°–ø–∏—Å–æ–∫ stash'–µ–π
git stash show -p stash@{0}            # –ü–∞—Ç—á –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ stash
```

### –í–æ–∑–≤—Ä–∞—Ç –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
git stash apply stash@{0}              # –ü—Ä–∏–º–µ–Ω–∏—Ç—å (stash –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ)
git stash pop                          # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞
git stash drop stash@{0}               # –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π stash
git stash clear                        # –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ stash'–∏ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ)
git stash branch fixup stash@{0}       # –°–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ –Ω–µ—ë stash
```

üí° **–ü—Ä–∏—ë–º:** –º–æ–∂–Ω–æ —Å—Ç—ç—à–∏—Ç—å –≤—ã–±–æ—Ä–æ—á–Ω–æ –ø–æ pathspec:
```bash
git stash push -m "only src" -- src/   # –°–ø—Ä—è—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ src/
```

---

## üß© Submodules ‚Äî –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

–ü–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å —á—É–∂–∏–µ/–æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∫–∞–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –†–æ–¥–∏—Ç–µ–ª—å —Ö—Ä–∞–Ω–∏—Ç **–∂—ë—Å—Ç–∫—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ—á–Ω—ã–π –∫–æ–º–º–∏—Ç** –ø–æ–¥–º–æ–¥—É–ª—è.

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –∫–ª–æ–Ω
```bash
git submodule add <url> path/to/module   # –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–º–æ–¥—É–ª—å
git submodule init                       # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
git submodule update                     # –í—ã–∫–∞—á–∞—Ç—å –∫–æ–º–º–∏—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —Å—Å—ã–ª–∞–µ—Ç—Å—è —Ä–æ–¥–∏—Ç–µ–ª—å
git submodule update --init --recursive  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–¥–º–æ–¥—É–ª–∏

git clone --recurse-submodules <url>     # –ö–ª–æ–Ω —Å—Ä–∞–∑—É —Å–æ –≤—Å–µ–º–∏ –ø–æ–¥–º–æ–¥—É–ª—è–º–∏
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
```bash
cd path/to/module
git fetch
git checkout <new-commit-or-branch>      # –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –Ω—É–∂–Ω—ã–π –∫–æ–º–º–∏—Ç/–≤–µ—Ç–∫—É
cd ../..
git add path/to/module                   # –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π pointer –≤ —Ä–æ–¥–∏—Ç–µ–ª–µ
git commit -m "Bump submodule to <hash>"
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏—ë–º—ã
```bash
git submodule foreach 'git status'       # –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤–æ –≤—Å–µ—Ö –ø–æ–¥–º–æ–¥—É–ª—è—Ö
git submodule sync --recursive           # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å URL'—ã –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π .gitmodules
```

‚ö†Ô∏è **–ü–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏:**
- –ü–æ–¥–º–æ–¥—É–ª—å –æ–±—ã—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ **detached HEAD** ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.  
- –õ—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è **–≤–Ω—É—Ç—Ä–∏ –ø–æ–¥–º–æ–¥—É–ª—è** –Ω–∞–¥–æ –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ –µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, –∑–∞—Ç–µ–º –æ–±–Ω–æ–≤–ª—è—Ç—å pointer –≤ —Ä–æ–¥–∏—Ç–µ–ª–µ.  
- –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ ¬´–ø—Ä–æ—Å—Ç–æ –ø–æ–ª–æ–∂–∏—Ç—å –∫–æ–¥¬ª –±–µ–∑ –∂—ë—Å—Ç–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–º–º–∏—Ç—É ‚Äî —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ **Git Subtree** –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É.

---

## üß™ –¢–∏–ø–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

**1) –ü—Ä–∏—è—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–¥ merge request:**
```bash
git fetch origin
git rebase -i origin/main          # squash/fixup/reword
git push --force-with-lease
```

**2) –°—Ä–æ—á–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ñ–∏–∫—Å –∏–∑ main –≤ —Ä–µ–ª–∏–∑–Ω—É—é –≤–µ—Ç–∫—É:**
```bash
git checkout release/1.2
git cherry-pick <fix-commit>
git push
```

**3) –ë—ã—Å—Ç—Ä–æ —Å–ø—Ä—è—Ç–∞—Ç—å ¬´–≥—Ä—è–∑–Ω—ã–µ¬ª –ø—Ä–∞–≤–∫–∏ –∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è:**
```bash
git stash push -u -m "WIP: feature X"
git switch hotfix/login-crash
# ...—Ñ–∏–∫—Å, –∫–æ–º–º–∏—Ç, –ø—É—à...
git switch -                        # –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥
git stash pop
```

**4) –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–¥–º–æ–¥—É–ª—å –¥–æ —Å–≤–µ–∂–µ–≥–æ —Ä–µ–ª–∏–∑–∞:**
```bash
cd libs/some-module
git fetch --tags
git checkout v2.3.0
cd ../..
git add libs/some-module
git commit -m "Bump some-module to v2.3.0"
```
